<import src="/template/search/search.wxml" />
<import src="/template/topnavs/topnavs.wxml" />
<import src="/template/tabs/tabs.wxml" />
<import src="/template/distribute/distribute.wxml" />

<view class="container" wx:if="{{ready}}">

  <view class="trades-head">
    <template is="search" data="{{...search, tradeStatus}}" />
  </view>

  <!-- <template is="topnavs" data="{{...topnavs}}" /> -->

  <!-- <view class="trades-head">
    <view class="trades-type">
      <template is="tabs" data="{{...tabs}}" />
    </view>
  </view> -->

  <view class="trades">
    <block wx:for="{{trades}}" wx:key="" wx:for-item="trade">
      <view class="trade">
        <view class="trade-info">
          <view class="trade-info-row">
            <text class="trade-info-tid">订 单 号：{{trade.id}}</text>
          </view>
          <view class="trade-info-row">
            <text class="trade-info-time">提交时间：{{trade.time}}</text>
          </view>
          <view class="trade-info-row">
            <text class="trade-info-receive-name">收 货 人：{{trade.receive_name}}</text>
            <text class="trade-info-receive-phone">{{trade.receive_phone || trade.mobileNumber || '13345678902'}}</text>
          </view>
          <view class="trade-info-row">
            <text class="trade-info-receive-address">收货地址：{{trade.receive_district + trade.receive_address}}</text>
          </view>
        </view>
        <view class="trade-status">{{trade.status}}</view>
        <view class="trade-operate">{{'买家收货'}}</view>
        <view class="trade-orders">
          <block wx:for="{{trade.orders}}" wx:key="" wx:for-item="order">
            <view class="order" data-iid="{{order.iid}}" catchtap="onOrderTap">
              <view class="order-image">
                <image src="{{order.image + youImageMode_v2}}" mode="aspectFill" />
              </view>
              <view class="order-text">
                <view class="order-text-title">{{order.title}}</view>
                <view class="order-text-descs gray">{{order.descs || order.title + '(500克)'}}</view>
                <view class="order-text-message gray" wx:if="{{order.message}}">{{order.message}}</view>
              </view>
              <view class="order-number">
                <view class="order-number-price">￥{{order.price}}</view>
                <view class="order-number-num" wx:if="{{order.realNum==''}}">{{order.num}}</view>
                <view class="order-number-num" wx:if="{{order.realNum!=''}}">
                  <text>{{order.realNum}}</text>
                  <text class="gray">{{'(' + order.num + ')'}}</text>
                </view>
              </view>
            </view>
          </block>
        </view>
        <view class="trade-count">
          <view class="trade-count-row" wx:if="{{trade.status=='买家提交'}}">
            <text class="trade-count-num">合计 数量：{{trade.num}}</text>
            <text class="trade-count-amount">金额：￥{{trade.amount}}</text>
          </view>
          <view class="trade-count-row" wx:if="{{trade.status!='买家提交'}}">
            <text class="trade-count-num">合计 数量：{{trade.realNum}}</text>
            <text class="trade-count-amount">金额：￥{{trade.realAmount}}</text>
          </view>
        </view>
      </view>
    </block>
  </view>

  <view class="trades" style="display:none">
    <block wx:for="{{trades}}" wx:key="" wx:for-item="trade">
      <view class="trade">
        <view class="trade-head" data-tid="{{trade.id}}" catchtap="onTradeTap">
          <view class="trade-infos">
            <view class="trade-info">下单时间：{{trade.time}}</view>
            <view class="trade-info">收 货 人：{{trade.receive_name}}</view>
            <view class="trade-info">联系电话：{{trade.receive_phone || trade.mobileNumber}}</view>
            <view class="trade-info">收货地址：{{trade.receive_district + trade.receive_address}}</view>
          </view>
          <view class="trade-button" wx:if="{{trade.distributed}}">发货</view>
        </view>
        <view class="orders">
          <block wx:for="{{trade.orders}}" wx:key="" wx:for-item="order">
            <view class="order" data-tid="{{trade.id}}" data-oid="{{order.id}}" catchtap="onOrderTap">
              <view class="order-image">
                <image src="{{order.image + youImageMode_v2}}" mode="aspectFill" />
              </view>
              <view class="order-text">
                <view class="order-title">{{order.title}}</view>
                <view class="order-descs">{{order.descs || order.title + '(500克)'}}</view>
              </view>
              <view class="order-number">
                <view class="order-num">{{order.num}}</view>
                <view class="order-realNum" wx:if="{{order.realNum!==''}}">实发 {{order.realNum}}</view>
              </view>
            </view>
          </block>
        </view>
      </view>
    </block>
  </view>

</view>